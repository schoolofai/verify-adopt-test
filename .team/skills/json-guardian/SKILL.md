---\nname: json-guardian\ndescription: Validate .team JSON/JSONL files against the team contract and fix malformed records before completion.\n---\n\n# JSON Guardian\n\nUse this skill whenever you create or modify `.team` files.\nNever declare a task/proposal/READY complete unless validation returns `ok=true`.\n\n## Validation tools\n\n- `octeams validate-team --json`\n- `octeams repair-team --json` (optional first-pass normalizer only; manual fixes are still required when issues remain)\n\n## Team data contract (.team)\n\n- `.team/board/*.json` (task JSON): `id`, `type`, `title`, `status`, `priority`, `required_role`, `depends_on[]`, `claimed_by`, `created_at`; comments must be `{ "from": "...", "text": "...", "at": "..." }`.\n- `.team/comms/inbox/*.jsonl`: one JSON object per line with `id`, `from`, `to`, `body`, `timestamp`, `read`, optional `type`.\n- `.team/comms/directives/*.jsonl`: one JSON object per line; each line must be either a directive (`id`, `from`, `to`, `urgency`, `action`, `affected_tasks[]`, `replacement_tasks[]`, `reason`, `timestamp`, `acknowledged`) or an ack (`ack`, `at`).\n- `.team/activity/*.jsonl`: one JSON object per line with `id`, `timestamp`, `event_type`, `agent_id`, `details`.\n- `.team/roster/*.json`: `id`, `role`, `status`, `current_task`, `registered_at`, `last_heartbeat`.\n- `.team/roster/_meta.json`: `{ "product": "<name>" }`.\n- `.team/team-proposal.json`: `status`, `proposed_at`, `rationale`, `roles[]` (with `role`, `count`, `description`, `soul_md`), optional prerequisites.\n- `.team/phase.json`: lifecycle phase record (`current`, `previous`, `started_at`, `transitioned_at`, `gate_criteria_met[]`, `sub_cycle`, `history[]`).\n\n## Required workflow\n\n1. Run `octeams validate-team --json` before completion messages, READY acks, or push.\n2. If validation fails, inspect each reported file/line and correct it manually.\n3. You may run `octeams repair-team --json` as a first pass, then continue manual correction.\n4. Re-run `octeams validate-team --json` until report shows `"ok": true`.\n5. Only then commit/push and send completion/READY messages.\n\n## Non-negotiable JSONL rule\n\n- JSONL is one complete JSON object per line.\n- Never use `echo`/`cat >>` to append partial or multiline objects.\n- Prefer `octeams msg`, `octeams issue-directive`, and other octeams commands for writes.\n\nAlways include the validation outcome when reporting completion.\n